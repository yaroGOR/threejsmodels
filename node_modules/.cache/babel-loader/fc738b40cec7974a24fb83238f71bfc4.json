{"ast":null,"code":"import { TempNode } from '../core/TempNode.js';\nimport { NodeLib } from '../core/NodeLib.js';\n\nfunction PositionNode(scope) {\n  TempNode.call(this, 'v3');\n  this.scope = scope || PositionNode.LOCAL;\n}\n\nPositionNode.LOCAL = 'local';\nPositionNode.WORLD = 'world';\nPositionNode.VIEW = 'view';\nPositionNode.PROJECTION = 'projection';\nPositionNode.prototype = Object.create(TempNode.prototype);\nPositionNode.prototype.constructor = PositionNode;\nPositionNode.prototype.nodeType = 'Position';\n\nPositionNode.prototype.getType = function () {\n  switch (this.scope) {\n    case PositionNode.PROJECTION:\n      return 'v4';\n  }\n\n  return this.type;\n};\n\nPositionNode.prototype.getShared = function ()\n/* builder */\n{\n  switch (this.scope) {\n    case PositionNode.LOCAL:\n    case PositionNode.WORLD:\n      return false;\n  }\n\n  return true;\n};\n\nPositionNode.prototype.generate = function (builder, output) {\n  var result;\n\n  switch (this.scope) {\n    case PositionNode.LOCAL:\n      if (builder.isShader('vertex')) {\n        result = 'transformed';\n      } else {\n        builder.requires.position = true;\n        result = 'vPosition';\n      }\n\n      break;\n\n    case PositionNode.WORLD:\n      if (builder.isShader('vertex')) {\n        return '( modelMatrix * vec4( transformed, 1.0 ) ).xyz';\n      } else {\n        builder.requires.worldPosition = true;\n        result = 'vWPosition';\n      }\n\n      break;\n\n    case PositionNode.VIEW:\n      result = builder.isShader('vertex') ? '-mvPosition.xyz' : 'vViewPosition';\n      break;\n\n    case PositionNode.PROJECTION:\n      result = builder.isShader('vertex') ? '( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )' : 'vec4( 0.0 )';\n      break;\n  }\n\n  return builder.format(result, this.getType(builder), output);\n};\n\nPositionNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.scope = source.scope;\n  return this;\n};\n\nPositionNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.scope = this.scope;\n  }\n\n  return data;\n};\n\nNodeLib.addKeyword('position', function () {\n  return new PositionNode();\n});\nNodeLib.addKeyword('worldPosition', function () {\n  return new PositionNode(PositionNode.WORLD);\n});\nNodeLib.addKeyword('viewPosition', function () {\n  return new PositionNode(PositionNode.VIEW);\n});\nexport { PositionNode };","map":{"version":3,"names":["TempNode","NodeLib","PositionNode","scope","call","LOCAL","WORLD","VIEW","PROJECTION","prototype","Object","create","constructor","nodeType","getType","type","getShared","generate","builder","output","result","isShader","requires","position","worldPosition","format","copy","source","toJSON","meta","data","getJSONNode","createJSONNode","addKeyword"],"sources":["/Users/98yaroslavgorban/Desktop/gltfjsx-forked/node_modules/three-stdlib/nodes/accessors/PositionNode.js"],"sourcesContent":["import { TempNode } from '../core/TempNode.js';\nimport { NodeLib } from '../core/NodeLib.js';\n\nfunction PositionNode(scope) {\n  TempNode.call(this, 'v3');\n  this.scope = scope || PositionNode.LOCAL;\n}\n\nPositionNode.LOCAL = 'local';\nPositionNode.WORLD = 'world';\nPositionNode.VIEW = 'view';\nPositionNode.PROJECTION = 'projection';\nPositionNode.prototype = Object.create(TempNode.prototype);\nPositionNode.prototype.constructor = PositionNode;\nPositionNode.prototype.nodeType = 'Position';\n\nPositionNode.prototype.getType = function () {\n  switch (this.scope) {\n    case PositionNode.PROJECTION:\n      return 'v4';\n  }\n\n  return this.type;\n};\n\nPositionNode.prototype.getShared = function ()\n/* builder */\n{\n  switch (this.scope) {\n    case PositionNode.LOCAL:\n    case PositionNode.WORLD:\n      return false;\n  }\n\n  return true;\n};\n\nPositionNode.prototype.generate = function (builder, output) {\n  var result;\n\n  switch (this.scope) {\n    case PositionNode.LOCAL:\n      if (builder.isShader('vertex')) {\n        result = 'transformed';\n      } else {\n        builder.requires.position = true;\n        result = 'vPosition';\n      }\n\n      break;\n\n    case PositionNode.WORLD:\n      if (builder.isShader('vertex')) {\n        return '( modelMatrix * vec4( transformed, 1.0 ) ).xyz';\n      } else {\n        builder.requires.worldPosition = true;\n        result = 'vWPosition';\n      }\n\n      break;\n\n    case PositionNode.VIEW:\n      result = builder.isShader('vertex') ? '-mvPosition.xyz' : 'vViewPosition';\n      break;\n\n    case PositionNode.PROJECTION:\n      result = builder.isShader('vertex') ? '( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )' : 'vec4( 0.0 )';\n      break;\n  }\n\n  return builder.format(result, this.getType(builder), output);\n};\n\nPositionNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.scope = source.scope;\n  return this;\n};\n\nPositionNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.scope = this.scope;\n  }\n\n  return data;\n};\n\nNodeLib.addKeyword('position', function () {\n  return new PositionNode();\n});\nNodeLib.addKeyword('worldPosition', function () {\n  return new PositionNode(PositionNode.WORLD);\n});\nNodeLib.addKeyword('viewPosition', function () {\n  return new PositionNode(PositionNode.VIEW);\n});\n\nexport { PositionNode };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}