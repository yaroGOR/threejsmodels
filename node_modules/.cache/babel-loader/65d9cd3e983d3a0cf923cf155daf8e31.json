{"ast":null,"code":"import { DefaultLoadingManager, FileLoader } from 'three';\nimport * as Nodes from '../nodes/Nodes.js';\n\nvar NodeMaterialLoader = function NodeMaterialLoader(manager, library) {\n  this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n  this.nodes = {};\n  this.materials = {};\n  this.passes = {};\n  this.names = {};\n  this.library = library || {};\n};\n\nvar NodeMaterialLoaderUtils = {\n  replaceUUIDObject: function replaceUUIDObject(object, uuid, value, recursive) {\n    recursive = recursive !== undefined ? recursive : true;\n    if (typeof uuid === 'object') uuid = uuid.uuid;\n\n    if (typeof object === 'object') {\n      var keys = Object.keys(object);\n\n      for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n\n        if (recursive) {\n          object[key] = this.replaceUUIDObject(object[key], uuid, value);\n        }\n\n        if (key === uuid) {\n          object[uuid] = object[key];\n          delete object[key];\n        }\n      }\n    }\n\n    return object === uuid ? value : object;\n  },\n  replaceUUID: function replaceUUID(json, uuid, value) {\n    this.replaceUUIDObject(json, uuid, value, false);\n    this.replaceUUIDObject(json.nodes, uuid, value);\n    this.replaceUUIDObject(json.materials, uuid, value);\n    this.replaceUUIDObject(json.passes, uuid, value);\n    this.replaceUUIDObject(json.library, uuid, value, false);\n    return json;\n  }\n};\nObject.assign(NodeMaterialLoader.prototype, {\n  load: function load(url, onLoad, onProgress, onError) {\n    var scope = this;\n    var loader = new FileLoader(scope.manager);\n    loader.setPath(scope.path);\n    loader.load(url, function (text) {\n      onLoad(scope.parse(JSON.parse(text)));\n    }, onProgress, onError);\n    return this;\n  },\n  setPath: function setPath(value) {\n    this.path = value;\n    return this;\n  },\n  getObjectByName: function getObjectByName(uuid) {\n    return this.names[uuid];\n  },\n  getObjectById: function getObjectById(uuid) {\n    return this.library[uuid] || this.nodes[uuid] || this.materials[uuid] || this.passes[uuid] || this.names[uuid];\n  },\n  getNode: function getNode(uuid) {\n    var object = this.getObjectById(uuid);\n\n    if (!object) {\n      console.warn('Node \"' + uuid + '\" not found.');\n    }\n\n    return object;\n  },\n  resolve: function resolve(json) {\n    switch (typeof json) {\n      case 'boolean':\n      case 'number':\n        return json;\n\n      case 'string':\n        if (/^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test(json) || this.library[json]) {\n          return this.getNode(json);\n        }\n\n        return json;\n\n      default:\n        if (Array.isArray(json)) {\n          for (var i = 0; i < json.length; i++) {\n            json[i] = this.resolve(json[i]);\n          }\n        } else {\n          for (var prop in json) {\n            if (prop === 'uuid') continue;\n            json[prop] = this.resolve(json[prop]);\n          }\n        }\n\n    }\n\n    return json;\n  },\n  declare: function declare(json) {\n    var uuid, node, object;\n\n    for (uuid in json.nodes) {\n      node = json.nodes[uuid];\n      object = new Nodes[node.nodeType + 'Node']();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.nodes[uuid] = object;\n    }\n\n    for (uuid in json.materials) {\n      node = json.materials[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.materials[uuid] = object;\n    }\n\n    for (uuid in json.passes) {\n      node = json.passes[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.passes[uuid] = object;\n    }\n\n    if (json.material) this.material = this.materials[json.material];\n    if (json.pass) this.pass = this.passes[json.pass];\n    return json;\n  },\n  parse: function parse(json) {\n    var uuid;\n    json = this.resolve(this.declare(json));\n\n    for (uuid in json.nodes) {\n      this.nodes[uuid].copy(json.nodes[uuid]);\n    }\n\n    for (uuid in json.materials) {\n      this.materials[uuid].copy(json.materials[uuid]);\n    }\n\n    for (uuid in json.passes) {\n      this.passes[uuid].copy(json.passes[uuid]);\n    }\n\n    return this.material || this.pass || this;\n  }\n});\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };","map":{"version":3,"names":["DefaultLoadingManager","FileLoader","Nodes","NodeMaterialLoader","manager","library","undefined","nodes","materials","passes","names","NodeMaterialLoaderUtils","replaceUUIDObject","object","uuid","value","recursive","keys","Object","i","length","key","replaceUUID","json","assign","prototype","load","url","onLoad","onProgress","onError","scope","loader","setPath","path","text","parse","JSON","getObjectByName","getObjectById","getNode","console","warn","resolve","test","Array","isArray","prop","declare","node","nodeType","name","type","material","pass","copy"],"sources":["/Users/98yaroslavgorban/Desktop/gltfjsx-forked/node_modules/three-stdlib/loaders/NodeMaterialLoader.js"],"sourcesContent":["import { DefaultLoadingManager, FileLoader } from 'three';\nimport * as Nodes from '../nodes/Nodes.js';\n\nvar NodeMaterialLoader = function (manager, library) {\n  this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n  this.nodes = {};\n  this.materials = {};\n  this.passes = {};\n  this.names = {};\n  this.library = library || {};\n};\n\nvar NodeMaterialLoaderUtils = {\n  replaceUUIDObject: function (object, uuid, value, recursive) {\n    recursive = recursive !== undefined ? recursive : true;\n    if (typeof uuid === 'object') uuid = uuid.uuid;\n\n    if (typeof object === 'object') {\n      var keys = Object.keys(object);\n\n      for (let i = 0; i < keys.length; i++) {\n        var key = keys[i];\n\n        if (recursive) {\n          object[key] = this.replaceUUIDObject(object[key], uuid, value);\n        }\n\n        if (key === uuid) {\n          object[uuid] = object[key];\n          delete object[key];\n        }\n      }\n    }\n\n    return object === uuid ? value : object;\n  },\n  replaceUUID: function (json, uuid, value) {\n    this.replaceUUIDObject(json, uuid, value, false);\n    this.replaceUUIDObject(json.nodes, uuid, value);\n    this.replaceUUIDObject(json.materials, uuid, value);\n    this.replaceUUIDObject(json.passes, uuid, value);\n    this.replaceUUIDObject(json.library, uuid, value, false);\n    return json;\n  }\n};\nObject.assign(NodeMaterialLoader.prototype, {\n  load: function (url, onLoad, onProgress, onError) {\n    var scope = this;\n    var loader = new FileLoader(scope.manager);\n    loader.setPath(scope.path);\n    loader.load(url, function (text) {\n      onLoad(scope.parse(JSON.parse(text)));\n    }, onProgress, onError);\n    return this;\n  },\n  setPath: function (value) {\n    this.path = value;\n    return this;\n  },\n  getObjectByName: function (uuid) {\n    return this.names[uuid];\n  },\n  getObjectById: function (uuid) {\n    return this.library[uuid] || this.nodes[uuid] || this.materials[uuid] || this.passes[uuid] || this.names[uuid];\n  },\n  getNode: function (uuid) {\n    var object = this.getObjectById(uuid);\n\n    if (!object) {\n      console.warn('Node \"' + uuid + '\" not found.');\n    }\n\n    return object;\n  },\n  resolve: function (json) {\n    switch (typeof json) {\n      case 'boolean':\n      case 'number':\n        return json;\n\n      case 'string':\n        if (/^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test(json) || this.library[json]) {\n          return this.getNode(json);\n        }\n\n        return json;\n\n      default:\n        if (Array.isArray(json)) {\n          for (let i = 0; i < json.length; i++) {\n            json[i] = this.resolve(json[i]);\n          }\n        } else {\n          for (let prop in json) {\n            if (prop === 'uuid') continue;\n            json[prop] = this.resolve(json[prop]);\n          }\n        }\n\n    }\n\n    return json;\n  },\n  declare: function (json) {\n    var uuid, node, object;\n\n    for (uuid in json.nodes) {\n      node = json.nodes[uuid];\n      object = new Nodes[node.nodeType + 'Node']();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.nodes[uuid] = object;\n    }\n\n    for (uuid in json.materials) {\n      node = json.materials[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.materials[uuid] = object;\n    }\n\n    for (uuid in json.passes) {\n      node = json.passes[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.passes[uuid] = object;\n    }\n\n    if (json.material) this.material = this.materials[json.material];\n    if (json.pass) this.pass = this.passes[json.pass];\n    return json;\n  },\n  parse: function (json) {\n    var uuid;\n    json = this.resolve(this.declare(json));\n\n    for (uuid in json.nodes) {\n      this.nodes[uuid].copy(json.nodes[uuid]);\n    }\n\n    for (uuid in json.materials) {\n      this.materials[uuid].copy(json.materials[uuid]);\n    }\n\n    for (uuid in json.passes) {\n      this.passes[uuid].copy(json.passes[uuid]);\n    }\n\n    return this.material || this.pass || this;\n  }\n});\n\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };\n"],"mappings":"AAAA,SAASA,qBAAT,EAAgCC,UAAhC,QAAkD,OAAlD;AACA,OAAO,KAAKC,KAAZ,MAAuB,mBAAvB;;AAEA,IAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUC,OAAV,EAAmBC,OAAnB,EAA4B;EACnD,KAAKD,OAAL,GAAeA,OAAO,KAAKE,SAAZ,GAAwBF,OAAxB,GAAkCJ,qBAAjD;EACA,KAAKO,KAAL,GAAa,EAAb;EACA,KAAKC,SAAL,GAAiB,EAAjB;EACA,KAAKC,MAAL,GAAc,EAAd;EACA,KAAKC,KAAL,GAAa,EAAb;EACA,KAAKL,OAAL,GAAeA,OAAO,IAAI,EAA1B;AACD,CAPD;;AASA,IAAIM,uBAAuB,GAAG;EAC5BC,iBAAiB,EAAE,2BAAUC,MAAV,EAAkBC,IAAlB,EAAwBC,KAAxB,EAA+BC,SAA/B,EAA0C;IAC3DA,SAAS,GAAGA,SAAS,KAAKV,SAAd,GAA0BU,SAA1B,GAAsC,IAAlD;IACA,IAAI,OAAOF,IAAP,KAAgB,QAApB,EAA8BA,IAAI,GAAGA,IAAI,CAACA,IAAZ;;IAE9B,IAAI,OAAOD,MAAP,KAAkB,QAAtB,EAAgC;MAC9B,IAAII,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYJ,MAAZ,CAAX;;MAEA,KAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACG,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;QACpC,IAAIE,GAAG,GAAGJ,IAAI,CAACE,CAAD,CAAd;;QAEA,IAAIH,SAAJ,EAAe;UACbH,MAAM,CAACQ,GAAD,CAAN,GAAc,KAAKT,iBAAL,CAAuBC,MAAM,CAACQ,GAAD,CAA7B,EAAoCP,IAApC,EAA0CC,KAA1C,CAAd;QACD;;QAED,IAAIM,GAAG,KAAKP,IAAZ,EAAkB;UAChBD,MAAM,CAACC,IAAD,CAAN,GAAeD,MAAM,CAACQ,GAAD,CAArB;UACA,OAAOR,MAAM,CAACQ,GAAD,CAAb;QACD;MACF;IACF;;IAED,OAAOR,MAAM,KAAKC,IAAX,GAAkBC,KAAlB,GAA0BF,MAAjC;EACD,CAvB2B;EAwB5BS,WAAW,EAAE,qBAAUC,IAAV,EAAgBT,IAAhB,EAAsBC,KAAtB,EAA6B;IACxC,KAAKH,iBAAL,CAAuBW,IAAvB,EAA6BT,IAA7B,EAAmCC,KAAnC,EAA0C,KAA1C;IACA,KAAKH,iBAAL,CAAuBW,IAAI,CAAChB,KAA5B,EAAmCO,IAAnC,EAAyCC,KAAzC;IACA,KAAKH,iBAAL,CAAuBW,IAAI,CAACf,SAA5B,EAAuCM,IAAvC,EAA6CC,KAA7C;IACA,KAAKH,iBAAL,CAAuBW,IAAI,CAACd,MAA5B,EAAoCK,IAApC,EAA0CC,KAA1C;IACA,KAAKH,iBAAL,CAAuBW,IAAI,CAAClB,OAA5B,EAAqCS,IAArC,EAA2CC,KAA3C,EAAkD,KAAlD;IACA,OAAOQ,IAAP;EACD;AA/B2B,CAA9B;AAiCAL,MAAM,CAACM,MAAP,CAAcrB,kBAAkB,CAACsB,SAAjC,EAA4C;EAC1CC,IAAI,EAAE,cAAUC,GAAV,EAAeC,MAAf,EAAuBC,UAAvB,EAAmCC,OAAnC,EAA4C;IAChD,IAAIC,KAAK,GAAG,IAAZ;IACA,IAAIC,MAAM,GAAG,IAAI/B,UAAJ,CAAe8B,KAAK,CAAC3B,OAArB,CAAb;IACA4B,MAAM,CAACC,OAAP,CAAeF,KAAK,CAACG,IAArB;IACAF,MAAM,CAACN,IAAP,CAAYC,GAAZ,EAAiB,UAAUQ,IAAV,EAAgB;MAC/BP,MAAM,CAACG,KAAK,CAACK,KAAN,CAAYC,IAAI,CAACD,KAAL,CAAWD,IAAX,CAAZ,CAAD,CAAN;IACD,CAFD,EAEGN,UAFH,EAEeC,OAFf;IAGA,OAAO,IAAP;EACD,CATyC;EAU1CG,OAAO,EAAE,iBAAUlB,KAAV,EAAiB;IACxB,KAAKmB,IAAL,GAAYnB,KAAZ;IACA,OAAO,IAAP;EACD,CAbyC;EAc1CuB,eAAe,EAAE,yBAAUxB,IAAV,EAAgB;IAC/B,OAAO,KAAKJ,KAAL,CAAWI,IAAX,CAAP;EACD,CAhByC;EAiB1CyB,aAAa,EAAE,uBAAUzB,IAAV,EAAgB;IAC7B,OAAO,KAAKT,OAAL,CAAaS,IAAb,KAAsB,KAAKP,KAAL,CAAWO,IAAX,CAAtB,IAA0C,KAAKN,SAAL,CAAeM,IAAf,CAA1C,IAAkE,KAAKL,MAAL,CAAYK,IAAZ,CAAlE,IAAuF,KAAKJ,KAAL,CAAWI,IAAX,CAA9F;EACD,CAnByC;EAoB1C0B,OAAO,EAAE,iBAAU1B,IAAV,EAAgB;IACvB,IAAID,MAAM,GAAG,KAAK0B,aAAL,CAAmBzB,IAAnB,CAAb;;IAEA,IAAI,CAACD,MAAL,EAAa;MACX4B,OAAO,CAACC,IAAR,CAAa,WAAW5B,IAAX,GAAkB,cAA/B;IACD;;IAED,OAAOD,MAAP;EACD,CA5ByC;EA6B1C8B,OAAO,EAAE,iBAAUpB,IAAV,EAAgB;IACvB,QAAQ,OAAOA,IAAf;MACE,KAAK,SAAL;MACA,KAAK,QAAL;QACE,OAAOA,IAAP;;MAEF,KAAK,QAAL;QACE,IAAI,oCAAoCqB,IAApC,CAAyCrB,IAAzC,KAAkD,KAAKlB,OAAL,CAAakB,IAAb,CAAtD,EAA0E;UACxE,OAAO,KAAKiB,OAAL,CAAajB,IAAb,CAAP;QACD;;QAED,OAAOA,IAAP;;MAEF;QACE,IAAIsB,KAAK,CAACC,OAAN,CAAcvB,IAAd,CAAJ,EAAyB;UACvB,KAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGI,IAAI,CAACH,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;YACpCI,IAAI,CAACJ,CAAD,CAAJ,GAAU,KAAKwB,OAAL,CAAapB,IAAI,CAACJ,CAAD,CAAjB,CAAV;UACD;QACF,CAJD,MAIO;UACL,KAAK,IAAI4B,IAAT,IAAiBxB,IAAjB,EAAuB;YACrB,IAAIwB,IAAI,KAAK,MAAb,EAAqB;YACrBxB,IAAI,CAACwB,IAAD,CAAJ,GAAa,KAAKJ,OAAL,CAAapB,IAAI,CAACwB,IAAD,CAAjB,CAAb;UACD;QACF;;IAtBL;;IA0BA,OAAOxB,IAAP;EACD,CAzDyC;EA0D1CyB,OAAO,EAAE,iBAAUzB,IAAV,EAAgB;IACvB,IAAIT,IAAJ,EAAUmC,IAAV,EAAgBpC,MAAhB;;IAEA,KAAKC,IAAL,IAAaS,IAAI,CAAChB,KAAlB,EAAyB;MACvB0C,IAAI,GAAG1B,IAAI,CAAChB,KAAL,CAAWO,IAAX,CAAP;MACAD,MAAM,GAAG,IAAIX,KAAK,CAAC+C,IAAI,CAACC,QAAL,GAAgB,MAAjB,CAAT,EAAT;;MAEA,IAAID,IAAI,CAACE,IAAT,EAAe;QACbtC,MAAM,CAACsC,IAAP,GAAcF,IAAI,CAACE,IAAnB;QACA,KAAKzC,KAAL,CAAWG,MAAM,CAACsC,IAAlB,IAA0BtC,MAA1B;MACD;;MAED,KAAKN,KAAL,CAAWO,IAAX,IAAmBD,MAAnB;IACD;;IAED,KAAKC,IAAL,IAAaS,IAAI,CAACf,SAAlB,EAA6B;MAC3ByC,IAAI,GAAG1B,IAAI,CAACf,SAAL,CAAeM,IAAf,CAAP;MACAD,MAAM,GAAG,IAAIX,KAAK,CAAC+C,IAAI,CAACG,IAAN,CAAT,EAAT;;MAEA,IAAIH,IAAI,CAACE,IAAT,EAAe;QACbtC,MAAM,CAACsC,IAAP,GAAcF,IAAI,CAACE,IAAnB;QACA,KAAKzC,KAAL,CAAWG,MAAM,CAACsC,IAAlB,IAA0BtC,MAA1B;MACD;;MAED,KAAKL,SAAL,CAAeM,IAAf,IAAuBD,MAAvB;IACD;;IAED,KAAKC,IAAL,IAAaS,IAAI,CAACd,MAAlB,EAA0B;MACxBwC,IAAI,GAAG1B,IAAI,CAACd,MAAL,CAAYK,IAAZ,CAAP;MACAD,MAAM,GAAG,IAAIX,KAAK,CAAC+C,IAAI,CAACG,IAAN,CAAT,EAAT;;MAEA,IAAIH,IAAI,CAACE,IAAT,EAAe;QACbtC,MAAM,CAACsC,IAAP,GAAcF,IAAI,CAACE,IAAnB;QACA,KAAKzC,KAAL,CAAWG,MAAM,CAACsC,IAAlB,IAA0BtC,MAA1B;MACD;;MAED,KAAKJ,MAAL,CAAYK,IAAZ,IAAoBD,MAApB;IACD;;IAED,IAAIU,IAAI,CAAC8B,QAAT,EAAmB,KAAKA,QAAL,GAAgB,KAAK7C,SAAL,CAAee,IAAI,CAAC8B,QAApB,CAAhB;IACnB,IAAI9B,IAAI,CAAC+B,IAAT,EAAe,KAAKA,IAAL,GAAY,KAAK7C,MAAL,CAAYc,IAAI,CAAC+B,IAAjB,CAAZ;IACf,OAAO/B,IAAP;EACD,CApGyC;EAqG1Ca,KAAK,EAAE,eAAUb,IAAV,EAAgB;IACrB,IAAIT,IAAJ;IACAS,IAAI,GAAG,KAAKoB,OAAL,CAAa,KAAKK,OAAL,CAAazB,IAAb,CAAb,CAAP;;IAEA,KAAKT,IAAL,IAAaS,IAAI,CAAChB,KAAlB,EAAyB;MACvB,KAAKA,KAAL,CAAWO,IAAX,EAAiByC,IAAjB,CAAsBhC,IAAI,CAAChB,KAAL,CAAWO,IAAX,CAAtB;IACD;;IAED,KAAKA,IAAL,IAAaS,IAAI,CAACf,SAAlB,EAA6B;MAC3B,KAAKA,SAAL,CAAeM,IAAf,EAAqByC,IAArB,CAA0BhC,IAAI,CAACf,SAAL,CAAeM,IAAf,CAA1B;IACD;;IAED,KAAKA,IAAL,IAAaS,IAAI,CAACd,MAAlB,EAA0B;MACxB,KAAKA,MAAL,CAAYK,IAAZ,EAAkByC,IAAlB,CAAuBhC,IAAI,CAACd,MAAL,CAAYK,IAAZ,CAAvB;IACD;;IAED,OAAO,KAAKuC,QAAL,IAAiB,KAAKC,IAAtB,IAA8B,IAArC;EACD;AAtHyC,CAA5C;AAyHA,SAASnD,kBAAT,EAA6BQ,uBAA7B"},"metadata":{},"sourceType":"module"}