{"ast":null,"code":"import { WebGLRenderTarget, UniformsUtils, ShaderMaterial, AdditiveBlending, Vector2, LinearFilter, RGBAFormat } from 'three';\nimport { FullScreenQuad, Pass } from './Pass.js';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { ConvolutionShader } from '../shaders/ConvolutionShader.js';\n\nvar BloomPass = function BloomPass(strength, kernelSize, sigma, resolution) {\n  strength = strength !== undefined ? strength : 1;\n  kernelSize = kernelSize !== undefined ? kernelSize : 25;\n  sigma = sigma !== undefined ? sigma : 4.0;\n  resolution = resolution !== undefined ? resolution : 256; // render targets\n\n  var pars = {\n    minFilter: LinearFilter,\n    magFilter: LinearFilter,\n    format: RGBAFormat\n  };\n  this.renderTargetX = new WebGLRenderTarget(resolution, resolution, pars);\n  this.renderTargetX.texture.name = 'BloomPass.x';\n  this.renderTargetY = new WebGLRenderTarget(resolution, resolution, pars);\n  this.renderTargetY.texture.name = 'BloomPass.y'; // copy material\n\n  if (CopyShader === undefined) console.error('THREE.BloomPass relies on CopyShader');\n  var copyShader = CopyShader;\n  this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n  this.copyUniforms['opacity'].value = strength;\n  this.materialCopy = new ShaderMaterial({\n    uniforms: this.copyUniforms,\n    vertexShader: copyShader.vertexShader,\n    fragmentShader: copyShader.fragmentShader,\n    blending: AdditiveBlending,\n    transparent: true\n  }); // convolution material\n\n  if (ConvolutionShader === undefined) console.error('THREE.BloomPass relies on ConvolutionShader');\n  var convolutionShader = ConvolutionShader;\n  this.convolutionUniforms = UniformsUtils.clone(convolutionShader.uniforms);\n  this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;\n  this.convolutionUniforms['cKernel'].value = ConvolutionShader.buildKernel(sigma);\n  this.materialConvolution = new ShaderMaterial({\n    uniforms: this.convolutionUniforms,\n    vertexShader: convolutionShader.vertexShader,\n    fragmentShader: convolutionShader.fragmentShader,\n    defines: {\n      KERNEL_SIZE_FLOAT: kernelSize.toFixed(1),\n      KERNEL_SIZE_INT: kernelSize.toFixed(0)\n    }\n  });\n  this.needsSwap = false;\n  this.fsQuad = new FullScreenQuad(null);\n};\n\nBloomPass.prototype = Object.assign(Object.create(Pass.prototype), {\n  constructor: BloomPass,\n  render: function render(renderer, writeBuffer, readBuffer, deltaTime, maskActive) {\n    if (maskActive) renderer.state.buffers.stencil.setTest(false); // Render quad with blured scene into texture (convolution pass 1)\n\n    this.fsQuad.material = this.materialConvolution;\n    this.convolutionUniforms['tDiffuse'].value = readBuffer.texture;\n    this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;\n    renderer.setRenderTarget(this.renderTargetX);\n    renderer.clear();\n    this.fsQuad.render(renderer); // Render quad with blured scene into texture (convolution pass 2)\n\n    this.convolutionUniforms['tDiffuse'].value = this.renderTargetX.texture;\n    this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurY;\n    renderer.setRenderTarget(this.renderTargetY);\n    renderer.clear();\n    this.fsQuad.render(renderer); // Render original scene with superimposed blur to texture\n\n    this.fsQuad.material = this.materialCopy;\n    this.copyUniforms['tDiffuse'].value = this.renderTargetY.texture;\n    if (maskActive) renderer.state.buffers.stencil.setTest(true);\n    renderer.setRenderTarget(readBuffer);\n    if (this.clear) renderer.clear();\n    this.fsQuad.render(renderer);\n  }\n});\nBloomPass.blurX = new Vector2(0.001953125, 0.0);\nBloomPass.blurY = new Vector2(0.0, 0.001953125);\nexport { BloomPass };","map":{"version":3,"names":["WebGLRenderTarget","UniformsUtils","ShaderMaterial","AdditiveBlending","Vector2","LinearFilter","RGBAFormat","FullScreenQuad","Pass","CopyShader","ConvolutionShader","BloomPass","strength","kernelSize","sigma","resolution","undefined","pars","minFilter","magFilter","format","renderTargetX","texture","name","renderTargetY","console","error","copyShader","copyUniforms","clone","uniforms","value","materialCopy","vertexShader","fragmentShader","blending","transparent","convolutionShader","convolutionUniforms","blurX","buildKernel","materialConvolution","defines","KERNEL_SIZE_FLOAT","toFixed","KERNEL_SIZE_INT","needsSwap","fsQuad","prototype","Object","assign","create","constructor","render","renderer","writeBuffer","readBuffer","deltaTime","maskActive","state","buffers","stencil","setTest","material","setRenderTarget","clear","blurY"],"sources":["/Users/98yaroslavgorban/Desktop/gltfjsx-forked/node_modules/three-stdlib/postprocessing/BloomPass.js"],"sourcesContent":["import { WebGLRenderTarget, UniformsUtils, ShaderMaterial, AdditiveBlending, Vector2, LinearFilter, RGBAFormat } from 'three';\nimport { FullScreenQuad, Pass } from './Pass.js';\nimport { CopyShader } from '../shaders/CopyShader.js';\nimport { ConvolutionShader } from '../shaders/ConvolutionShader.js';\n\nvar BloomPass = function (strength, kernelSize, sigma, resolution) {\n  strength = strength !== undefined ? strength : 1;\n  kernelSize = kernelSize !== undefined ? kernelSize : 25;\n  sigma = sigma !== undefined ? sigma : 4.0;\n  resolution = resolution !== undefined ? resolution : 256; // render targets\n\n  var pars = {\n    minFilter: LinearFilter,\n    magFilter: LinearFilter,\n    format: RGBAFormat\n  };\n  this.renderTargetX = new WebGLRenderTarget(resolution, resolution, pars);\n  this.renderTargetX.texture.name = 'BloomPass.x';\n  this.renderTargetY = new WebGLRenderTarget(resolution, resolution, pars);\n  this.renderTargetY.texture.name = 'BloomPass.y'; // copy material\n\n  if (CopyShader === undefined) console.error('THREE.BloomPass relies on CopyShader');\n  var copyShader = CopyShader;\n  this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n  this.copyUniforms['opacity'].value = strength;\n  this.materialCopy = new ShaderMaterial({\n    uniforms: this.copyUniforms,\n    vertexShader: copyShader.vertexShader,\n    fragmentShader: copyShader.fragmentShader,\n    blending: AdditiveBlending,\n    transparent: true\n  }); // convolution material\n\n  if (ConvolutionShader === undefined) console.error('THREE.BloomPass relies on ConvolutionShader');\n  var convolutionShader = ConvolutionShader;\n  this.convolutionUniforms = UniformsUtils.clone(convolutionShader.uniforms);\n  this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;\n  this.convolutionUniforms['cKernel'].value = ConvolutionShader.buildKernel(sigma);\n  this.materialConvolution = new ShaderMaterial({\n    uniforms: this.convolutionUniforms,\n    vertexShader: convolutionShader.vertexShader,\n    fragmentShader: convolutionShader.fragmentShader,\n    defines: {\n      KERNEL_SIZE_FLOAT: kernelSize.toFixed(1),\n      KERNEL_SIZE_INT: kernelSize.toFixed(0)\n    }\n  });\n  this.needsSwap = false;\n  this.fsQuad = new FullScreenQuad(null);\n};\n\nBloomPass.prototype = Object.assign(Object.create(Pass.prototype), {\n  constructor: BloomPass,\n  render: function (renderer, writeBuffer, readBuffer, deltaTime, maskActive) {\n    if (maskActive) renderer.state.buffers.stencil.setTest(false); // Render quad with blured scene into texture (convolution pass 1)\n\n    this.fsQuad.material = this.materialConvolution;\n    this.convolutionUniforms['tDiffuse'].value = readBuffer.texture;\n    this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;\n    renderer.setRenderTarget(this.renderTargetX);\n    renderer.clear();\n    this.fsQuad.render(renderer); // Render quad with blured scene into texture (convolution pass 2)\n\n    this.convolutionUniforms['tDiffuse'].value = this.renderTargetX.texture;\n    this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurY;\n    renderer.setRenderTarget(this.renderTargetY);\n    renderer.clear();\n    this.fsQuad.render(renderer); // Render original scene with superimposed blur to texture\n\n    this.fsQuad.material = this.materialCopy;\n    this.copyUniforms['tDiffuse'].value = this.renderTargetY.texture;\n    if (maskActive) renderer.state.buffers.stencil.setTest(true);\n    renderer.setRenderTarget(readBuffer);\n    if (this.clear) renderer.clear();\n    this.fsQuad.render(renderer);\n  }\n});\nBloomPass.blurX = new Vector2(0.001953125, 0.0);\nBloomPass.blurY = new Vector2(0.0, 0.001953125);\n\nexport { BloomPass };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}